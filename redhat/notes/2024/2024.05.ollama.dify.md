# ollama with dify

- https://github.com/langgenius/dify

# deploy dify with ollama

```bash

yum install -y yum-utils
yum-config-manager --add-repo https://download.docker.com/linux/rhel/docker-ce.repo

yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

systemctl enable --now docker

mkdir -p /data

cd /data

# git clone https://github.com/langgenius/dify
git clone https://github.com/wangzheng422/dify.git
cd dify
git checkout wzh

cd docker
/bin/cp -f .env.wzh .env
# podman compose -f podman-compose.yaml \
#     up -d 

docker compose up -d
# docker compose down

docker ps -a
# CONTAINER ID   IMAGE                              COMMAND                  CREATED          STATUS                    PORTS                                                                      NAMESca71da5a0ffe   nginx:latest                       "sh -c 'cp /docker-e…"   26 minutes ago   Up 26 minutes             0.0.0.0:80->80/tcp, :::80->80/tcp, 0.0.0.0:443->443/tcp, :::443->443/tcp   docker-nginx-1
# 354aa16bddab   langgenius/dify-api:0.6.16         "/bin/bash /entrypoi…"   26 minutes ago   Up 26 minutes             5001/tcp                                                                   docker-worker-1
# a8ff67526ddb   langgenius/dify-api:0.6.16         "/bin/bash /entrypoi…"   26 minutes ago   Up 26 minutes             5001/tcp                                                                   docker-api-1
# 4b1e9fa22b67   langgenius/dify-web:0.6.16         "/bin/sh ./entrypoin…"   26 minutes ago   Up 26 minutes             3000/tcp                                                                   docker-web-1
# 0953e45f1db8   ubuntu/squid:latest                "sh -c 'cp /docker-e…"   26 minutes ago   Up 26 minutes             3128/tcp                                                                   docker-ssrf_proxy-1
# 53bb37b548b6   redis:6-alpine                     "docker-entrypoint.s…"   26 minutes ago   Up 26 minutes (healthy)   6379/tcp                                                                   docker-redis-1
# 10e4be45b409   postgres:15-alpine                 "docker-entrypoint.s…"   26 minutes ago   Up 26 minutes (healthy)   5432/tcp                                                                   docker-db-1
# 8f6359cda8cb   langgenius/dify-sandbox:0.2.1      "/main"                  26 minutes ago   Up 26 minutes                                                                                        docker-sandbox-1
# 8ff81855ec04   semitechnologies/weaviate:1.19.0   "/bin/weaviate --hos…"   26 minutes ago   Up 26 minutes                                                                                        docker-weaviate-1

# go to http://server_ip/
# admin@wzhlab.top  /   redhat123


# install ollama
# https://ollama.com/download/linux
curl -fsSL https://ollama.com/install.sh | sh

mkdir -p /etc/systemd/system/ollama.service.d

cat << EOF > /etc/systemd/system/ollama.service.d/override.conf
[Service]
Environment="OLLAMA_HOST=0.0.0.0"
EOF

systemctl daemon-reload

systemctl restart ollama

# ollama run llama3.1:latest
ollama run gemma2:2b

```